import io.github.bonigarcia.wdm.WebDriverManager;
import io.github.seleniumwire.SeleniumWireDriver;
import org.openqa.selenium.edge.EdgeOptions;
import java.util.Map;

public class InterceptDownload {
    public static void main(String[] args) {
        WebDriverManager.edgedriver().setup();
        
        EdgeOptions options = new EdgeOptions();
        SeleniumWireDriver driver = new SeleniumWireDriver(options);

        try {
            driver.get("https://your-sharepoint-site-url");

            // Simulate actions to trigger the file download
            driver.findElement(By.xpath("//a[contains(text(), 'your-file-name')]")).click();

            // Intercept network requests
            driver.getDevTools().createSession();
            driver.getDevTools().addListener(Network.responseReceived(), response -> {
                if (response.getResponse().getUrl().contains("your-file-name.extension")) {
                    System.out.println("File URL: " + response.getResponse().getUrl());
                }
            });

        } finally {
            driver.quit();
        }
    }
}