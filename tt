# Assume wb and ws are already defined (open workbook)

# Map header names to column numbers
header_map = {ws.cell(row=1, column=col).value: col for col in range(1, ws.max_column + 1)}

# Define header name pairs to compare
pairs = [
    ("First Name", "First Name Check"),
    ("Last Name", "Last Name Check"),
    ("DOB", "DOB Check"),
    ("Email", "Email Check")
]

# Add Status column dynamically
status_col = ws.max_column + 1
ws.cell(row=1, column=status_col, value="Status")

# Compare row by row
for row in range(2, ws.max_row + 1):
    mismatches = []
    for h1, h2 in pairs:
        v1 = str(ws.cell(row=row, column=header_map[h1]).value or "").strip().lower()
        v2 = str(ws.cell(row=row, column=header_map[h2]).value or "").strip().lower()
        if v1 != v2:
            mismatches.append(f"{h1}â‰ {h2}")
    
    # Write result
    ws.cell(row=row, column=status_col, value="Pass" if not mismatches else "Fail - " + ", ".join(mismatches))

# Save workbook
wb.save("your_file_checked.xlsx")