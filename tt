import io.restassured.RestAssured;
import io.restassured.response.Response;
import org.json.JSONObject;
import java.nio.file.Files;
import java.nio.file.Paths;
import static io.restassured.RestAssured.given;

public class RestAssuredSecureTest {
    public static void main(String[] args) {
        String jsonFilePath = "data.json"; // Path to your JSON file
        String apiHost = "https://your-api-host.com"; // API host URL

        try {
            // Read JSON file content
            String jsonContent = new String(Files.readAllBytes(Paths.get(jsonFilePath)));

            // Convert to JSON Object
            JSONObject jsonObject = new JSONObject(jsonContent);

            // Modify JSON request body dynamically
            JSONObject requestBody = new JSONObject();
            requestBody.put("fam", jsonObject.getString("fam")); // Using 'fam' from file
            requestBody.put("name", "John Doe");
            requestBody.put("age", 30);
            requestBody.put("items", new String[]{"UpdatedItem", "Item2"});

            // Setup RestAssured
            RestAssured.baseURI = apiHost;

            // Send POST request with relaxed SSL validation
            Response response = given()
                    .relaxedHTTPSValidation() // Ignore SSL issues (self-signed certs, expired certs, etc.)
                    .header("Content-Type", "application/json")
                    .header("cust", "value") // Custom header
                    .body(requestBody.toString())
                    .when()
                    .post("/update")  // API endpoint
                    .then()
                    .statusCode(200)  // Expecting HTTP 200 OK response
                    .extract()
                    .response();

            // Print response
            System.out.println("Response: " + response.getBody().asString());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}