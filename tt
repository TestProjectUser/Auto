import os
import shutil
from datetime import datetime
import win32com.client as win32

# --- CONFIG ---
template_file = r"C:\path\to\template.xlsx"
output_folder = r"C:\path\to\output"
Col = ["acb", "fdt", "ghy"]   # your values to write

# --- STEP 1: Copy template with timestamp ---
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
output_file = os.path.join(output_folder, f"template_copy_{timestamp}.xlsx")
shutil.copy(template_file, output_file)

# --- STEP 2: Open with existing Excel object ---
excel = win32.gencache.EnsureDispatch("Excel.Application")
excel.Visible = True   # keep visible for debugging

wb = excel.Workbooks.Open(output_file)
ws = wb.Sheets(1)  # first sheet

# --- STEP 3: Write values starting from row 2 ---
row = 2
col_start = 1   # write starting from column A
for i, val in enumerate(Col, start=col_start):
    ws.Cells(row, i).Value = val

# --- Save ---
wb.Save()
print(f"File saved: {output_file}")