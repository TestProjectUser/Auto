import io.github.bonigarcia.wdm.WebDriverManager;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.edge.EdgeDriver;

import java.time.Duration;

public class SharePointLogin {

    public static void main(String[] args) {
        // Set up WebDriver for Edge
        WebDriverManager.edgedriver().setup();
        WebDriver driver = new EdgeDriver();

        try {
            // Navigate to the SharePoint login page
            driver.get("https://your-sharepoint-site-url");

            // Wait for the page to load
            driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));

            // Enter the email address
            WebElement emailField = driver.findElement(By.id("i0116")); // "i0116" is the email input field ID
            emailField.sendKeys("your-email@example.com");
            driver.findElement(By.id("idSIButton9")).click(); // Click "Next"

            // Wait for the password page to load
            Thread.sleep(2000);

            // Enter the password
            WebElement passwordField = driver.findElement(By.id("i0118")); // "i0118" is the password input field ID
            passwordField.sendKeys("your-password");
            driver.findElement(By.id("idSIButton9")).click(); // Click "Sign in"

            // Handle "Stay signed in" prompt if it appears
            Thread.sleep(2000);
            if (driver.findElements(By.id("idSIButton9")).size() > 0) {
                driver.findElement(By.id("idSIButton9")).click(); // Click "Yes"
            }

            // Successfully logged in, navigate to the desired SharePoint page
            Thread.sleep(5000);
            driver.get("https://your-sharepoint-site-url/specific-page");

            System.out.println("Successfully logged into SharePoint.");
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            driver.quit();
        }
    }
}