import io.restassured.RestAssured;
import io.restassured.response.Response;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class ExcelRestAssuredPOI {

    public static void main(String[] args) {
        String filePath = "./data.xlsx";

        try (FileInputStream fis = new FileInputStream(new File(filePath));
             Workbook workbook = new XSSFWorkbook(fis)) {

            // Access the first sheet
            Sheet sheet = workbook.getSheetAt(0);

            // Read the value from the first cell (A1)
            Row row = sheet.getRow(0);
            Cell cell = row.getCell(0);
            String cellValue = cell.getStringCellValue();
            System.out.println("Value from Excel (A1): " + cellValue);

            // Make an API request using Rest-Assured
            RestAssured.baseURI = "https://example.com/api";
            Response response = RestAssured.given()
                    .header("Content-Type", "application/xml")
                    .body("<Request><Id>" + cellValue + "</Id></Request>")
                    .post("/endpoint"); // Replace with your actual endpoint

            String responseBody = response.asString();
            System.out.println("API Response: " + responseBody);

            // Write the response to the second cell (B1)
            Cell responseCell = row.createCell(1, CellType.STRING);
            responseCell.setCellValue(responseBody);

            // Write the updated workbook back to the file
            try (FileOutputStream fos = new FileOutputStream(new File(filePath))) {
                workbook.write(fos);
            }

            System.out.println("Response written to Excel (B1).");

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}