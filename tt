# Create mapping dictionary from mapper sheet
mapping = dict(zip(df_map["json_field"], df_map["xls_field"]))

# Rename only columns that exist in JSON
df_json_renamed = df_json.rename(columns={k: v for k, v in mapping.items() if k in df_json.columns})

# Final list of columns = only those that exist after rename
valid_cols = [col for col in mapping.values() if col in df_json_renamed.columns]

df_json_final = df_json_renamed[valid_cols]