import win32com.client

# Open Excel
excel = win32com.client.Dispatch("Excel.Application")
excel.Visible = False  # Set to True to show the Excel window

# Open the workbook (DO NOT supply password unless file is workbook-level protected)
wb = excel.Workbooks.Open(r"C:\Path\To\File1.xlsm")  # Update with full path

# Run the macro (use full name if module is required, e.g., "Module1.YourMacro")
macro_name = "YourMacroName"  # Update with your actual macro name
excel.Application.Run(macro_name)

# Save and close the workbook
wb.Close(SaveChanges=True)
excel.Quit()