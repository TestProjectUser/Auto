for test_name in self.test_data.get("tests", []):
    for _, rule in rule_df.iterrows():
        src_col = rule["src_col"]
        dest_col = rule["dest_col"]
        dest_sheet = rule["dest_sheet"]

        # Find row in source by test_name
        src_row = src_df[src_df["TestName"] == test_name]
        if src_row.empty:
            results.append({"test": test_name, "status": "Not found in source"})
            continue

        src_val = src_row[src_col].iloc[0]

        # Find row in destination by test_name
        dest_data = dest_df[dest_sheet]
        dest_row = dest_data[dest_data["TestName"] == test_name]

        if dest_row.empty:
            results.append({"test": test_name, "status": "Not found in dest"})
            continue

        dest_val = dest_row[dest_col].iloc[0]

        status = "Pass" if src_val == dest_val else "Fail"
        results.append({
            "test": test_name,
            "src_col": src_col, "src_val": src_val,
            "dest_sheet": dest_sheet, "dest_col": dest_col, "dest_val": dest_val,
            "status": status
        })